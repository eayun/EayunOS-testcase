##测试点1：集群的操作   

####实验说明：    
本实验是对EayunOS 4.1的集群的基础操作。这个实验的目标是创建一个新的集群，让其管理属于这个集群的主机。让集群中的虚拟机可以在该集群中的主机上自由迁移。      
####实验目标：新建集群

####预置条件：必须有一个数据中心，默认的数据中心也算。

####预期结果：创建集群成功。    

####测试步骤：   
 
  &nbsp;   &nbsp;  &nbsp;1. 可以在创建完数据中心后，在【新建数据中心-引导操作】中点击【配置集群】来创建集群；如果点击了【以后再配置】，则可以点击数据中心菜单中的【引导操作】，重新打开该窗口，点击【配置集群】；或点击树形面板中的【展开所有】按键，选择默认数据中心的集群，在其菜单中点击【新建】按键 。    
  &nbsp;   &nbsp;  &nbsp;2.在弹出的【新建集群】窗口中，可以对左侧选项进行一一配置，在本实验中，配置如下： 

    在【常规】标签中输入名称、描述、注释，选择CPU类型为Intel SandyBridge Family，其他保持默认配置
    在【优化】标签中设置内存优化、CPU线程、内存Balloon、KSM控件（新的），使用默认配置
    在【Resilience策略】标签中选择【移植虚拟机】的策略
    在【集群策略】和【控制台】标签下的配置使用默认配置
    在【隔离策略】标签下，勾选Enable Fencing     
&nbsp;   &nbsp;  &nbsp;3.点击【确定】，集群新建成功，仍然显示【新建数据中心-引导虚拟机的创建和使用 操作】窗口，可以点击【以后再配置】跳过剩下的操作，也可以继续进行（如果是直接在集群标签下新建，则没有【新建数据中心-引导操作】的窗口显示，会返回集群列表中）。

####测试结果：创建集群成功。      

---
####实验目标： 配置网络之在集群上配置网络 

####预置条件：新建一个数据中心并且没有配置逻辑网络。

####预期结果：网络配置成功    

####测试步骤：     
1.在左侧树形面板中点击【展开所有】按键，点击选择【数据中心】，在右侧的详细列表中显示数据中心，选择所创建的数据中心，点击【逻辑网络】子标签，点击【新建】按键    
2.在弹出的【新建逻辑网络】窗口中，输入名称（必填）、描述和注释（选填），其他配置使用默认配置
点击【确定】，完成逻辑网络的创建 

####测试结果：网络配置成功

----
####实验目标： 配置网络之在主机上配置网络 

####预置条件：必须有一个数据中心、一个集群，默认的也算，主机添加成功后。

####预期结果：主机网络网络配置成功    

####测试步骤：   
1.在左侧树形面板中点击【展开所有】按键，点击选择【主机】，在右侧的详细列表中显示主机列表，选择一台主机    
2.点击【网络接口】子标签，点击【设立主机网络】，在弹出的【设立主机网络】窗口中，将右侧的所新建的网络拖动到主机的网卡上，点击【确定】   
3.为主机添加网络成功 
####测试结果：主机网络配置成功。
----     
####实验目标：编辑集群    
####预置条件：有一个创建好的集群。
####预期结果：编辑集群成功    
####测试步骤：    
  &nbsp;   &nbsp;  &nbsp;1.点击树形面板中的【展开所有】按键，选择默认数据中心的集群，在其菜单中点击【编辑】按键 。      
  &nbsp;   &nbsp;  &nbsp;2.在弹出的【编辑集群】窗口中，可以对左侧选项进行一一配置，在本实验中，配置如下： 

    在【常规】标签中修改名称、描述、注释，选择CPU类型为Intel SandyBridge Family，其他保持默认配置
    在【优化】标签中设置内存优化、CPU线程、内存Balloon、KSM控件（新的），使用默认配置
    在【Resilience策略】标签中选择【移植虚拟机】的策略
    在【集群策略】和【控制台】标签下的配置使用默认配置
    在【隔离策略】标签下，勾选Enable Fencing           
####测试结果：编辑集群成功      
----
####实验目标：删除集群    
####预置条件：有一个创建好的集群。并且这个集群里没有运行的虚拟机，同时也没有别的功能在依赖这个集群。
####预期结果：删除集群成功    
####测试步骤：    
  &nbsp;   &nbsp;  &nbsp;1.点击树形面板中的【展开所有】按键，选择默认数据中心的集群，在其菜单中点击【删除】按键 。      
  &nbsp;   &nbsp;  &nbsp;2.在弹出的【删除集群】窗口中，点击【确定】，集群被删除。    
####测试结果：删除集群成功
  ----     
####实验目标：创建Affinity组
####预置条件：有一个创建好的集群。
####测试步骤：    
  &nbsp;   &nbsp;  &nbsp;1.选中创建好的集群，在下方面板中选择Affinity组。点击【新建】，在新建Affinity组选项卡中输入名称、描述。点击【确定】。
####测试结果：Affinity组创建成功。
----
####实验目标：删除Affinity组
####预置条件：有一个创建好的集群和一个创建好的Affinity组。
####测试步骤：    
&nbsp;   &nbsp;  &nbsp;1.选中创建好的集群，在下方面板中选择Affinity组。点击【删除】，在删除Affinity组面板中点击【确定】，Affinity组被删除。
####测试结果：Affinity组删除成功
虚拟机的创建和使用 
####本章小结：在这章里我们学会了集群的创建，编辑，以及删除。没有发现预期结果和测试结果不通的地方，测试通过。     
###测试目标： 添加NFS存储  
####预置条件：添加主机成功，主机网络配置成功。
####预期结果：NFS存储添成功
####测试步骤：
1.下载NFS软件包:# yum install nfs-utils    
2.配置 NFS 开机启动:    # chkconfig --add rpcbind
                         # chkconfig --add nfs
                         # chkconfig rpcbind on
                        # chkconfig nfs on     
3.如果是第一次配置,需要手动把 nfs 服务启动: # service rpcbind start
                                              # service nfs start       
4.创建共享目录：（以 /export/good 为例子）
                    # mkdir /exports/good
                    # chown -R 36:36 /exports/good        
5.配置共享目录：打开 nfs 的配置文件---vi /etc/exports,添加一行 /exports/good * (rw)    
6.重载 NFS 服务：# service nfs reload       
7. 登录到Engine管理端，在左侧树形面板中点击【展开所有】按键，在默认数据中心的默认集群下点击选择【存储】   
8.在右侧的详细列表中，点击菜单中的【新建域】按键     
9.在弹出的【新建域】窗口中，选择域功能/存储类型为【Data/NFS】，输入域的名称（必填）、描述和注释（选填），选择使用主机，在导出路径中填写配置的NFS域的路径，格式为FQDN://path或IP://path，其他配置保持默认配置    
10.点击【确定】，NFS数据域创建成功，数据域的状态变化为Locked -> Active                                               
####测试结果：NFS存储添成功
----
####测试目标： 添加iSCSI数据域 
####预置条件：添加主机成功，主机网络配置成功。
####预期结果：iSCSI数据域存储添成功
####测试步骤：   
1.安装相关软件包：yum install -y scsi-target-utils   
2.编辑 /etc/tgt/targets.conf 文件,增加以下几行内容：    
                                                  \<target iqn.2014-03.com.example:server.target0>                                                                                                
                                                       backing-store /dev/sdb # LUN 1   
                                                        backing-store /dev/sdc # LUN 2
                                                       \</target>   
3.重启 tgtd 服务。    
  # service tgtd restart   
4.让 tgtd 服务开机启动.
  # chkconfig tgtd on    
5.如果配置了 iptables 防火墙,必须把 iSCSI 用来和客户端通信的端口(默认是 3260)打开  
  # iptables -I INPUT 6 -p tcp --dport 3260 -j ACCEPT   
6.保存 iptables 的配置 
  # service iptables save   
7.登录到Engine管理端，在左侧树形面板中点击【展开所有】按键，在默认数据中心的默认集群下点击选择【存储】  
8.在右侧的详细列表中，点击菜单中的【新建域】按键   
9.在弹出的【新建域】窗口中，选择域功能/存储类型为【Data/iSCSI】，输入域的名称（必填）、描述和注释（选填），选择使用主机   
10.在下方的窗口中，填写iSCSI的地址（可以使用IP也可以使用FQDN），端口为3260，点击【发现】    
11.在发现的目标列表中，选择一个要target，点击右侧的登录图标    
12.点击target前方的【+】图标，展开这个target下的所有LUN，勾选要添加的LUN，点击【确定】  
13.iSCSI数据域创建成功，数据域的状态变化为Locked -> Active  
####测试结果：iSCSI数据域存储添加成功
----
####测试目标： 添加ISO域 (本实验中以NFS类型的ISO域为例 )
####预置条件：添加主机成功，主机网络配置成功。
####预期结果：ISO域添成功
####测试步骤：   
1.下载NFS软件包:# yum install nfs-utils    
2.配置 NFS 开机启动:    # chkconfig --add rpcbind
                         # chkconfig --add nfs
                         # chkconfig rpcbind on
                        # chkconfig nfs on     
3.如果是第一次配置,需要手动把 nfs 服务启动: # service rpcbind start
                                              # service nfs start       
4.创建共享目录：（以 /export/good/iso 为例子）
                    # mkdir /exports/good/iso
                    # chown -R 36:36 /exports/good/iso        
5.配置共享目录：打开 nfs 的配置文件---vi /etc/exports,添加一行 /exports/good/iso  *(rw)    
6.重载 NFS 服务：# service nfs reload          
7.登录到Engine管理端，在左侧树形面板中点击【展开所有】按键，在默认数据中心的默认集群下点击选择【存储】   
8.在右侧的详细列表中，点击菜单中的【新建域】按键    
9.在弹出的【新建域】窗口中，选择域功能/存储类型为【ISO/NFS】，输入域的名称（必填）、描述和注释（选填），选择使用主机，在导出路径中填写配置的ISO域的路径，格式为FQDN://path或IP://path(以192.168.3.115:/exports/good/iso为例),其他保持默认配置   
10.点击【确定】，ISO域创建成功，状态变化为Locked -> Active，存储能够使用     
####测试步骤2  
1.登录到Engine管理端，在左侧的树形面板中点击【展开所有】按键，在默认数据中心的默认集群下，点击选择【存储】   
2.看到一个未被附加的ISO域，状态为Unattached，选择该ISO域     
3.点击该域的【数据中心】子标签，在其子标签的菜单中点击【附加】   
4.在弹出的【附加到数据中心】窗口中，选择要附加的数据中心，点击【确定】   
5.ISO域被成功附加到数据中心，ISO域的状态变化为Locked -> Maintenance，点击【激活】后，状态变化为Activing -> Active，存储能够使用 