# 新建 Affinity 组

| **用例编号** | **测试目的** | **测试步骤** | **预期结果** | **实际结果** | **备注** |
| ------------ | ------------ | ------------ | ------------ | ------------ | -------- |
| 0080900 | 验证【名称】输入框中只可包含字母 **'.'**，**'_'** 或 **'-'** 字符。 | 1. 点击【虚拟机】标签，选择一台虚拟机。<br/> 2. 在下面的子标签中选择 【Affinity 组】这个标签并点击【新建】按扭，会弹出【新建 Affinity 组】。<br/> 3. 在【名称】旁边的输入框中输入**关联组!@#$%^&*() ?><}{":**，点击**确定**。 | 【新建 Affinity】窗口没有关闭，且【名称】旁边的输入框变成红色，将鼠标移入输入框中，会显示 **名称只包含字母数字字符( UTF 支持的任何语言, 包括 RTL 语言), 数字, '.','_' 或 '-' 字符** | 与预期结果一致。 | |
| 0080901 | 验证【名称】输入框中只可包含 254 个字符。 | 1. 点击【虚拟机】标签，选择一台虚拟机。<br/> 2. 在下面的子标签中选择 【Affinity 组】这个标签并点击【新建】按扭，会弹出【新建 Affinity 组】。<br/> 3. 在【名称】旁边的输入框中输入 254 个字符，点击【确定】。 | 【新建 Affinity】窗口自动关闭，在关联组列表中存在刚刚创建的关联组。 | 会弹出【操作被取消】这个窗口并报错：Error while executing action AddAffinityGroup: Internal Engine Error。 | 见 https://github.com/eayun/ovirt-engine/issues/45 |
| 0080902 | 验证【描述】输入框中只可包含遵循了标准 ASCII 字符集的字母数字字符和特殊字符。 | 1. 点击【虚拟机】标签，选择一台虚拟机。<br/> 2. 在下面的子标签中选择 【Affinity 组】这个标签并点击【新建】按扭，会弹出【新建 Affinity 组】。<br/> 3. 在【描述】旁边的输入框中输入 **！@#￥%……&*（的の**，点击【确定】。 | 【新建 Affinity】窗口没有关>闭，且【名称】旁边的输入框变成红色，将鼠标移入输入框中，会显示 **只允许遵循了标准 ASCII 字符集的字母数字字符和特殊字符 | 与预期结果一致。如果输入的是英文输入法下的特殊字符（例如：**!@#$%^&**），是可以被接受的。 | |
| 0080903 | 验证同一个关联组下的虚拟机的【Affinity 组】子标签下的关联组列表中中都具有该关联组。 | 1. 点击【虚拟机】标签，选择一台虚拟机。<br/> 2. 在下面的子标签中选择 【Affinity 组】这个标签并点击【新建】按扭，会弹出【新建 Affinity 组】。<br/> 3. 输入响应的【名称】和【描述】后，勾选【Positive】来和其它的虚拟机进行关联。4. 点击【+】按扭，选择要与该虚拟机进行关联的虚拟机 （此步骤可重复多次），点击【确定】。 | 到各个被关联的虚拟机的 【Affinity】 组中查看到列表中确实有刚刚创建的那个 Affinity 组。 | 与预期结果一致。 |
| 0080904 | 在不考虑主机内存，CPU 使用紧张的情况下，验证具有【Positive + Hard Enforcement】属性的关联组下有两台虚拟机，且其中一台正处于关闭状态的虚拟机在开启后会在另一虚拟机所在的主机上运行。 | 1. 点击【虚拟机】标签，选择一台运行在【主机A】上的【虚拟机a】。<br/> 2. 在下面的子标签中选择 【Affinity 组】这个标签并点击【新建】按扭，会弹出【新建 Affinity 组】。<br/> 3. 在【名称】旁边的输入框中输入该 Affinity 组的名称。4. 勾选 【Positive】 和 【Enforcing】。5. 点击【+】按扭，在下拉菜单中选择【虚拟机b】，点击【确定】。5. 编辑【虚拟机b】，在左侧的标签栏中选择【主机】，点击【专有的】，选择【主机B】，点击【确定】。6. 开启【虚拟机b】。 | 虚拟机均在同一台主机，即【主机A】上开启。 | 与预期结果一致。 |
| 0080905 | 在不考虑主机内存，CPU 使用紧张的情况下，验证具有【Positive + Soft Enforcement】属性的关联组下有两台虚拟机，且其中一台正处于关闭状态的虚拟机在开启后有可能不在同一台主机上运行。 | 1. 点击【虚拟机】标签，选择一台运行在【主机A】上的【虚拟机a】。<br/> 2. 在下面的子标签中选择 【Affinity 组】这个标签并点击【新建】按扭，会弹出【新建 Affinity 组】。<br/> 3. 在【名称】旁边的输入框中输入该 Affinity 组的名称。4. 勾选 【Positive】 和 【Enforcing】。5. 点击【+】按扭，在下拉菜单中选择【虚拟机b】，点击【确定】。5. 编辑【虚拟机b】，在左侧的标签栏中选择【主机】，点击【专有的】，选择【主机B】，点击【确定】。6. 开启【虚拟机b】。 | 【虚拟机b】并没有在【主机A】上开启，而是在【主机B】上成功开启。 | 与预期结果一致。 | 
| 0080906 | 在不考虑主机内存，CPU 使用紧张的情况下，验证具有【Negative + Hard Enforcement】属性的关联组下有两台虚拟机，且其中一台正处于关闭状态的虚拟机在开启后一定不会和另一台虚拟机运行在同一台主机上。 |  1. 点击【虚拟机】标签，选择一台运行在【主机A】上的【虚拟机a】。<br/> 2. 在下面的子标签中选择 【Affinity 组】这个标签并点击【新建】按扭，会弹出【新建 Affinity 组】。<br/> 3. 在【名称】旁边的输入框中输入该 Affinity 组的名称。4. 不勾选 【Positive】，只勾选 【Enforcing】。5. 点击【+】按扭，在下拉菜单中选择【虚拟机b】，点击【确定】。5. 编辑【虚拟机b】，在左侧的标签栏中选择【主机A】，点击【专有的】，选择【主机A】，点击【确定】。6. 开启【虚拟机b】。 | 【虚拟机b】并没有在【主机A】上开启，而是在另一台主机上成功开启。 | 与预期结果一致。 |
| 0080907 | 在不考虑主机内存，CPU 使用紧张的情况下，验证具有【Negative + Soft Enforcement】属性的关联组下有两台虚拟机，且其中有一台正处于关闭状态的虚拟机在开启后有可能会与另一台虚拟机在同一主机上开启。| 1. 点击【虚拟机】标签，选择一台运行在【主机A】上的【虚拟机a】。<br/> 2. 在下面的子标签中选择 【Affinity 组】这个标签并点击【新建】按扭，会弹出【新建 Affinity 组】。<br/> 3. 在【名称】旁边的输入框中输入该 Affinity 组的名称。4. 不勾选 【Positive】 和 【Enforcing】。5. 点击【+】按扭，在下拉菜单中选择【虚拟机b】，点击【确定】。5. 编辑【虚拟机b】，在左侧的标签栏中选择【主机】，点击【专有的】，选择【主机A】，点击【确定】。6. 开启【虚拟机b】。 | 【虚拟机b】并没有在其它非【主机A】上开启，而是在【主机A】上成功开启。 | 与预期结果一致。 |
| 0080908 | 在不考虑主机内存，CPU 使用紧张等的情况下，验证具有【Positive + Hard Enforcement】属性的关联组下有两台虚拟机，且其中一台正处于关闭状态的虚拟机在开启后会在另一虚拟机所在的主机上运行。 | 1. 点击【虚拟机】标签，选择一台运行在【主机A】上的【虚拟机a】。<br/> 2. 在下面的子标签中选择 【Affinity 组】这个标签并点击【新建】按扭，会弹出【新建 Affinity 组】。<br/> 3. 在【名称】旁边的输入框中输入该 Affinity 组的名称。4. 勾选 【Positive】 和 【Enforcing】。5. 点击【+】按扭，在下拉菜单中选择【虚拟机b】，点击【确定】。5. 编辑【虚拟机b】，在左侧的标签栏中选择【主机】，点击【专有的】，选择【主机B】，点击【确定】。6. 开启【虚拟机b】。 | 虚拟机均在同一台主机，即【主机A】上开启。 | 与预期结果一致。 |
| 0080909 | 在不考虑主机内存，CPU 使用紧张的情况下，验证具有【Positive + Soft Enforcement】属性的关联组下有两台虚拟机，且其中一台正处于关闭状态的虚拟机在开启后有可能不在同一台主机上运行。 | 1. 点击【虚拟机】标签，选择一台运行在【主机A】上的【虚拟机a】。<br/> 2. 在下面的子标签中选择 【Affinity 组】这个标签并点击【新建】按扭，会弹出【新建 Affinity 组】。<br/> 3. 在【名称】旁边的输入框中输入该 Affinity 组的名称。4. 勾选 【Positive】 和 【Enforcing】。5. 点击【+】按扭，在下拉菜单中选择【虚拟机b】，点击【确定】。5. 编辑【虚拟机b】，在左侧的标签栏中选择【主机】，点击【专有的】，选择【主机B】，点击【确定】。6. 开启【虚拟机b】>。 | 【虚拟机b】并没有在【主机A】上开启，而是在【主机B】上成功开启。 | 与预期结果一致。 | 
| 0080910 | 在不考虑主机内存，CPU 使用紧张的情况下，验证具有【Negative + Hard Enforcement】属性的关联组下有两台虚拟机，且其中一台正处于关闭状态的虚拟机在开启后一定不会和另一台虚拟机运行在同一台主机上。 |  1. 点击【虚拟机】标签，选择一台运行在【主机A】上的【虚拟机a】。<br/> 2. 在下面的子标签中选择 【Affinity 组】这个标签并点击【新建】按扭，会弹出【新建 Affinity 组】。<br/> 3. 在【名称】旁边的输入框中输入该 Affinity 组的名称。4. 不勾选 【Positive】，只勾选 【Enforcing】。5. 点击【+】按扭，在下拉菜单中选择【虚拟机b】，点击【确定】。5. 编辑【虚拟机b】，在左侧的标签栏中选择【主机A】，点击【专有的】，选择【主机A】，点击【确>定】。6. 开启【虚拟机b】。 | 【虚拟机b】并没有在【主机A】上开启，而是在另一台主机上成功开启。 | 与预期结果一致。 |
| 0080911 | 在不考虑主机内存，CPU 使用紧张的情况下，验证具有【Negative + Soft Enforcement】属性的关联组下有两台虚拟机，且其中有一台正处于关闭状态的虚拟机在开启后有可能会与另一台虚拟机在同一主机上开启。| 1. 点>击【虚拟机】标签，选择一台运行在【主机A】上的【虚拟机a】。<br/> 2. 在下面的子标签中选择 【Affinity 组】这个标签并点击【新建】按扭，会弹出【新建 Affinity 组】。<br/> 3. 在【名称】旁边的输入框中输入该 Affinity >组的名称。4. 不勾选 【Positive】 和 【Enforcing】。5. 点击【+】按扭，在下拉菜单中选择【虚拟机b】，点击【确定】。5. 编辑【虚拟机b】，在左侧的标签栏中选择【主机】，点击【专有的】，选择【主机A】，点击【确定】。6. 开启【虚拟机b】。 | 【虚拟机b】并没有在其它非【主机A】上开启，而是在【主机A】上成功开启。 | 与预期结果一致。 |
| 0080912 | 验证具有【Positive + Hard Enforcement】属性的关联组下的两台虚拟机且其中有一台处于关机状态的虚拟机由于一些特殊原因（例如：内存过大，超出了主机可以承受的范围）以至于不能正常启动。 | | |
| 0080913 | 验证具有【Positive + Soft Enforcement】属性的关联组下的两台虚拟机且其中有一台处于关机状态的虚拟机由于一些特殊原因（例如：内存过大，超出了主机可以承受的范围）不能在另一台运行着的虚拟机上所在的那台主机上启动，即而选择集群中另一个主机来作为自己的目的主机。 | |
| 0080914 | 验证具有【Positive + Hard Enforcement】属性的关联组下的两台运行在同一集群的不同主机上的虚拟机可以通过迁移的方式运行在同一个主机上。 |
| 0080915 | 验证具有【Positive + Soft Enforcement】属性的关联组下的两台运行在同一集群的不同主机上的虚拟机可以通过迁移的方式运行在同一个主机上。 | 
| 0080916 | 验证具有【Positive + Hard Enforcement】属性的关联组下的三台虚拟机，其中两台分别运行在同一集群的不同主机中，第三台虚拟机处于关机状态。 |
| 0080917 | 验证具有【Positive + Soft Enforcement】属性的关联组下的三台虚拟机，其中两台 |
