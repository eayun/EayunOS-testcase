<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
    "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
    <!ENTITY % BOOK_ENTITIES SYSTEM "Test_Case.ent">
    %BOOK_ENTITIES;
]>
<section>
  <title>高级存储功能</title>

  <informaltable  frame='topbot'>
    <tgroup cols='5' align='left' colsep='1' rowsep='1'>
      <colspec colname='c1' colwidth='5*'/>
      <colspec colname='c2' colwidth='20*'/>
      <colspec colname='c3' colwidth='10*'/>
      <colspec colname='c4' colwidth='5*'/>
      <colspec colname='c5' colwidth='10*'/>
      <thead>
        <row>
          <entry>用例编号</entry>
          <entry>操作</entry>
          <entry>预期结果</entry>
          <entry>实际结果</entry>
          <entry>备注</entry>
        </row>
      </thead>
      <tbody>
        <row>
          <entry>30</entry>
          <entry>
            <para>
              创建浮动磁盘.前提:
            </para>
            <itemizedlist>
              <listitem>
                <para>
                  已经配置好了标准的 &OVIRT; 的环境, 或者至少配置好了最小化得 &OVIRT; 环境
                </para>
              </listitem>
              <listitem>
                <para>
                  已经配置好 &OVIRT; 环境, 并能利用该环境安装虚拟机
                </para>
              </listitem>
            </itemizedlist>
            <orderedlist numeration="arabic">
              <listitem>
                <para>
                  在导航面板上点击<keycap>磁盘</keycap>标签
                </para>
              </listitem>

              <listitem>
                <para>
                  点击导航面板左上角的<keycap>添加</keycap>按钮. 一个添加虚拟磁盘的
                  面板将会打开.
                </para>
              </listitem>

              <listitem>
                <para>
                  在大小的输入框里, 输入<keycap>10</keycap>, 设置磁盘大小为 10GB.
                </para>
              </listitem>

              <listitem>
                <para>
                  在<keycap>别名</keycap>输入框里, 输入 Alias.
                </para>
              </listitem>

              <listitem>
                <para>
                  在<keycap>描述</keycap>输入框里输入相关的描述.
                </para>
              </listitem>

              <listitem>
                <para>
                  其它设置保留默认.
                </para>
              </listitem>

              <listitem>
                <para>
                  点击窗口又下角的<keycap>确定</keycap>创建虚拟磁盘.
                </para>
              </listitem>
            </orderedlist>

          </entry>
          <entry>
            <para>
              一个名为 Disk1 的浮动磁盘已经创建好了, 在虚拟机的磁盘列表上能正常显示.
            </para>
          </entry>

          <entry>
            <para>
            </para>
          </entry>
          <entry>
            <para>
            </para>
          </entry>
        </row>

        <row>
          <entry>31</entry>
          <entry>
            <para>
              给虚拟机分配浮动磁盘
            </para>
            <orderedlist numeration="arabic">
              <listitem>
                <para>
                  在导航面板上点击<keycap>虚拟机</keycap>标签.
                </para>
              </listitem>

              <listitem>
                <para>
                  从显示的虚拟机列表上选择待操作的虚拟机, 鼠标单击该虚拟机, 可以看到下
                  方的详细面板上将会显示该虚拟机的所有信息.
                </para>
              </listitem>

              <listitem>
                <para>
                  在详细信息面板上, 点击<keycap>磁盘</keycap>, 将会显示附加到该虚拟机
                  上的所有磁盘.
                </para>
              </listitem>

              <listitem>
                <para>
                  点击<keycap>添加</keycap>, 打开<keycap>添加磁盘</keycap>窗口.
                </para>
              </listitem>

              <listitem>
                <para>
                  勾选<keycap>附加磁盘</keycap>, 将会列出所有<keycap>浮动磁盘</keycap>.
                </para>
              </listitem>

              <listitem>
                <para>
                  选择上面创建的附加磁盘 <keycap>Disk1</keycap>.
                </para>
              </listitem>

              <listitem>
                <para>
                  点击窗口又下角的<keycap>确定</keycap>给虚拟机分配浮动磁盘.
                </para>
              </listitem>
            </orderedlist>
          </entry>

          <entry>
            <para>
              将 Disk1 分配给了虚拟机, 能在虚拟机的磁盘列表上看到 Disk1.
            </para>
          </entry>
          <entry>
            <para>
            </para>
          </entry>
          <entry>
            <para>
            </para>
          </entry>
        </row>
        <row>
          <entry>32</entry>
          <entry>
            <para>
              Virtual Machine Interruption
            </para>
            <orderedlist numeration="arabic">
              <listitem>
                <para>
                  在host上运行多个虚拟机，并把其中一些设
                  置为高可用；
                </para>
              </listitem>
              <listitem>
                <para>
                  在host上登录终端，使用vdsClient命令，查
                  看进程列表；
                </para>
              </listitem>
              <listitem>
                <para>
                  根据虚拟机的进程id，使用“kill -9”杀掉虚
                  拟机进程；
                </para>
              </listitem>
              <listitem>
                <para>
                  观察虚拟机列表，其中高可用虚拟机会立刻
                  重新启动，而非高可用虚拟机处于停止状
                  态； 
                </para>
              </listitem>
            </orderedlist>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
        </row>
        <row>
          <entry>33</entry>
          <entry>
            <para>
              Non-Operational Host(Host是SPM)
            </para>
            <orderedlist numeration="arabic">
              <listitem>
                <para>
                  查看storage网络的名字和物理接口。在
                  “Host"tab中选择要操作的host，点击
                  “Network Interfaces”子tab，可以看到其至
                  少有一个rhevm网络和一个storage网络。在
                  Tree面板中点击“ISCSI-share”，在
                  “Storage”tab中选择“ISCSI-share”，点击
                  “Edit”打开“Edit Domain”对话框，点击“+”
                  显示iSCSI目标；
                </para>
              </listitem>
              <listitem>
                <para>
                  通过ssh连接到host，使用ifconfig命令确认
                  网络连接正常。根据storage网络的名字，用
                  ifdown命令关闭storage网络；
                </para>
              </listitem>
              <listitem>
                <para>
                  由于host是SPM的，所以它会立刻自动重启。
                  高可用虚拟机会在cluster中其他可用host上
                  启动，非高可用虚拟机会暂停。而一旦这台
                  host重新运行，原来运行在这条host上的虚
                  拟机会重新迁移回这条host运行；
                </para>
              </listitem>
            </orderedlist>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
        </row>
        <row>
          <entry>34</entry>
          <entry>
            <para>
              Non-Operational Host（Host不是SPM）
            </para>
            <orderedlist numeration="arabic">
              <listitem>
                <para>
                  操作步骤同host不是spm的情况；
                </para>
              </listitem>
              <listitem>
                <para>
                  与SPM情况不同，host上的所有虚拟机都会迁
                  移到其他host上运行；
                </para>
              </listitem>
              <listitem>
                <para>

                </para>
              </listitem>
            </orderedlist>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
        </row>
        <row>
          <entry>35</entry>
          <entry>
            <para>
              Non-responsive host（连接破坏）
            </para>
            <orderedlist numeration="arabic">
              <listitem>
                <para>
                  首先查看host的网络信息，然后使用ifdown
                  命令关闭其rhevm网络（注意，上一个case是
                  关闭storage网络）；
                </para>
              </listitem>
              <listitem>
                <para>
                  高可用虚拟机会在其他host上重新启动，非
                  高可用虚拟机不会；
                </para>
              </listitem>
              <listitem>
                <para>

                </para>
              </listitem>
            </orderedlist>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
        </row>
        <row>
          <entry>36</entry>
          <entry>
            <para>
              Non-responsive host（不正确保护）
            </para>
            <orderedlist numeration="arabic">
              <listitem>
                <para>
                  在Hosts tab中选择要操作的虚拟机，点击
                  “Power Management”下拉菜单中的
                  “Restart”，来重启host；
                </para>
              </listitem>
              <listitem>
                <para>
                  host重启完毕后，高可用虚拟机会立刻重新
                  运行，在host重启过程中，高可用虚拟机会
                  在其它host上运行。而非高可用虚拟机会始
                  终处于关闭状态；
                </para>
              </listitem>
              <listitem>
                <para>

                </para>
              </listitem>
            </orderedlist>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
        </row>
        <row>
          <entry>23</entry>
          <entry>
            <para>
              配置网络（Host）
            </para>
            <orderedlist numeration="arabic">
              <listitem>
                <para>

                </para>
              </listitem>
              <listitem>
                <para>

                </para>
              </listitem>
              <listitem>
                <para>

                </para>
              </listitem>
            </orderedlist>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
        </row>
        <row>
          <entry>23</entry>
          <entry>
            <para>
              配置网络（Host）
            </para>
            <orderedlist numeration="arabic">
              <listitem>
                <para>

                </para>
              </listitem>
              <listitem>
                <para>

                </para>
              </listitem>
              <listitem>
                <para>

                </para>
              </listitem>
            </orderedlist>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
          <entry>
            <para>

            </para>
          </entry>
        </row>
        <row>
          <entry>...</entry>
          <entry>
            <para>...</para>
            <para>...</para>
          </entry>
          <entry>
            <para>...</para>
          </entry>
          <entry>
          </entry>
          <entry>
          </entry>
        </row>
      </tbody>
    </tgroup>
  </informaltable>

  <note>
    <para>
      其他注意事项：
    </para>
  </note>
</section>

